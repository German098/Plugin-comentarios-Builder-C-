//---------------------------------------------------------------------------

#pragma hdrstop

#include "ActionServicesNotifier.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)

__fastcall ActionServicesNotifier::ActionServicesNotifier() {
	//index = module->AddNotifier(this);
	//name = ChangeFileExt(ExtractFileName(module->FileName), "");
}

__fastcall ActionServicesNotifier::~ActionServicesNotifier() {
	//if(index >= 0)
    //    module->RemoveNotifier(index);
}

// IOTAActionServices
bool __fastcall ActionServicesNotifier::CloseFile(const System::UnicodeString FileName) {
    return true;
}

bool __fastcall ActionServicesNotifier::OpenFile(const System::UnicodeString FileName) {
	return true;
}

bool __fastcall ActionServicesNotifier::OpenProject(const System::UnicodeString ProjName, bool NewProjGroup) {
	return true;
}

bool __fastcall ActionServicesNotifier::ReloadFile(const System::UnicodeString FileName) {
	return true;
}

bool __fastcall ActionServicesNotifier::SaveFile(const System::UnicodeString FileName) {
DoNotification("Guardar");
  MessageDlg("Hello Dave... How are you...", mtInformation, TMsgDlgButtons() << mbOK, 0);
	return true;
}

// IOTANotifier

void __fastcall ModuleNotifier::AfterSave() {

}

void __fastcall ModuleNotifier::BeforeSave() {

}

void __fastcall ModuleNotifier::Destroyed() {
	/*if(index >= 0) {
		module->RemoveNotifier(index);
		index = -1;
	}

    module = 0;        */
}

void __fastcall ModuleNotifier::Modified() {

}

// IInterface

HRESULT __stdcall ModuleNotifier::QueryInterface(const GUID& iid, void** obj) {
  //QUERY_INTERFACE(IOTAModuleNotifier, iid, obj);
  if ((iid) == __uuidof(IOTAActionServices)) {
	*(obj) = static_cast<IOTAActionServices*>(this);
	static_cast<IOTAActionServices*>(*(obj))->AddRef();
	return S_OK;
  }

  return inherited::QueryInterface(iid, obj);
}

ULONG __stdcall ModuleNotifier::AddRef() {
	return inherited::AddRef();
}

ULONG __stdcall ModuleNotifier::Release() {
	return inherited::Release();
}